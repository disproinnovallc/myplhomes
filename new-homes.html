<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Nuevos Modelos | PL Homes</title>
  <link rel="stylesheet" href="style.css" />
  <meta name="description" content="Modelos nuevos de casas prefabricadas y modulares. Filtra por recámaras, baños, tamaño y precio.">
</head>
<body>
  <header>
    <nav class="navbar">
      <div class="logo"><img src="logo.png" alt="PL Homes Logo" /></div>
      <ul class="nav-links">
        <li><a href="index.html">Inicio</a></li>
        <li><a href="new-homes.html">Casas</a></li>
        <li><a href="financiamiento.html">Financiamiento</a></li>
        <li><a href="ubicaciones.html">Ubicaciones</a></li>
        <li><a href="contacto.html">Contacto</a></li>
      </ul>
    </nav>
  </header>

  <section class="hero">
    <div class="hero-overlay">
      <h1>Nuevos Modelos</h1>
      <p>Explora nuestra selección y filtra según tus necesidades.</p>
    </div>
  </section>

  <section class="about-section" style="max-width:1100px;">
    <!-- Filtros -->
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:10px;margin-bottom:16px">
      <input id="q" placeholder="Buscar modelo..." />
      <select id="tipo">
        <option value="">Todos los tipos</option>
        <option>Single-wide</option>
        <option>Double-wide</option>
        <option>Triple-wide</option>
        <option>Modular</option>
      </select>
      <select id="beds">
        <option value="">Recámaras</option>
        <option>2</option>
        <option>3</option>
        <option>4</option>
      </select>
      <select id="baths">
        <option value="">Baños</option>
        <option>2</option>
        <option>3</option>
        <option>4</option>
      </select>
      <select id="sqft">
        <option value="">Tamaño (ft²)</option>
        <option value="0-1200">0–1,200</option>
        <option value="1201-1600">1,201–1,600</option>
        <option value="1601-2500">1,601–2,500</option>
        <option value="2501-9999">2,501+</option>
      </select>
      <select id="price">
        <option value="">Precio</option>
        <option value="0-150000">Hasta 150k</option>
        <option value="150001-170000">150k–170k</option>
        <option value="170001-999999">170k+</option>
      </select>
      <select id="sort">
        <option value="">Ordenar</option>
        <option value="price-asc">Precio ↑</option>
        <option value="price-desc">Precio ↓</option>
        <option value="sqft-asc">Tamaño ↑</option>
        <option value="sqft-desc">Tamaño ↓</option>
      </select>
    </div>

    <!-- Grid -->
    <div class="grid-modelos" id="grid"></div>

    <!-- Paginación -->
    <div id="pager" style="margin-top:16px;display:flex;gap:8px;flex-wrap:wrap"></div>
  </section>

  <footer class="footer">
    <p>&copy; 2025 PL Homes. Todos los derechos reservados.</p>
  </footer>

  <script>
  (async function(){
    const res = await fetch('data/models.json', {cache:'no-store'});
    let all = await res.json();
    const grid = document.getElementById('grid');
    const pager = document.getElementById('pager');
    const q = document.getElementById('q'), tipo = document.getElementById('tipo'),
          beds = document.getElementById('beds'), baths = document.getElementById('baths'),
          sqft = document.getElementById('sqft'), price = document.getElementById('price'),
          sort = document.getElementById('sort');

    const PAGE = 12; let page = 1;

    function inRange(v, range){
      if(!range) return true;
      const [a,b] = range.split('-').map(Number);
      return v >= a && v <= b;
    }

    function apply(){
      let list = all.filter(m =>
        (!q.value || m.name.toLowerCase().includes(q.value.toLowerCase())) &&
        (!tipo.value || m.type === tipo.value) &&
        (!beds.value || m.beds == +beds.value) &&
        (!baths.value || m.baths == +baths.value) &&
        (!sqft.value || inRange(m.sqft, sqft.value)) &&
        (!price.value || (m.price && inRange(m.price, price.value)))
      );

      if(sort.value){
        const [field,dir] = sort.value.split('-');
        list.sort((a,b)=> (a[field]-b[field]) * (dir==='asc'?1:-1));
      }

      render(list);
    }

    function render(list){
      const total = Math.max(1, Math.ceil(list.length / PAGE));
      if(page > total) page = 1;
      const slice = list.slice((page-1)*PAGE, page*PAGE);

      grid.innerHTML = slice.map(m => `
        <article class="card-modelo">
          <img src="${m.image}" alt="${m.name}">
          <h3>${m.name}</h3>
          <p>${m.beds} recámaras · ${m.baths} baños · ${m.sqft.toLocaleString()} ft² · ${m.type}${m.price? ` · desde $${m.price.toLocaleString()}`:''}</p>
          <a class="btn-secondary" href="models/${m.slug}.html">Ver detalles</a>
        </article>
      `).join('');

      pager.innerHTML = Array.from({length: total}, (_,i)=>i+1).map(i =>
        `<button ${i===page?'style="background:#e66800;color:#fff;border:none;padding:6px 10px;border-radius:4px"':'style="padding:6px 10px;border:1px solid #ddd;border-radius:4px;background:#fff"'} onclick="(${(n)=>{page=n;apply();}})(${i})">${i}</button>`
      ).join(' ');
    }

    [q,tipo,beds,baths,sqft,price,sort].forEach(el=>el.addEventListener('input',()=>{page=1;apply();}));
    apply();
  })();
  </script>
</body>
</html>
